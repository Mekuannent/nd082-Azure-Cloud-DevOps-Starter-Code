{
  "type": "Microsoft.Authorization/policyDefinitions",
  "name": "policy-tagging",
  "properties": {
    "mode": "all",
    "displayName": "Deny resources with no tags",
    "desciption": "Deny the creation of resources that do not have tags"
    "policyRule": {
	   "if": {
	      "allOf": [{
              "field": "type",
              "equals": "Microsoft.Compute/virtualMachines"
             },
             {
              "field": "tags",
              "exists": false
             }]
       },
         "then": {
    	    "effect": "deny"
	      }
    }
}

az policy definition create --name 'policy-tagging' --display-name 'Deny create if no tags' --description 'Deny the creation of resources that do not have tags.' --rules 'policy-tagging.json' --mode All
